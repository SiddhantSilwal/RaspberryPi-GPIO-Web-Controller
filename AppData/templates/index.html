<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Raspi GPIO Controller</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />

    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polygon points='15,0 50,20 15,40' style='fill:%2375A52D'/><polygon points='85,0 50,20 85,60' style='fill:%2375A52D'/><circle cx='50' cy='60' r='40' fill='%23C51E3A'/><rect x='45' y='50' width='10' height='40' fill='white' rx='5'/><ellipse cx='50' cy='55' rx='18' ry='11' fill='white'/></svg>"
    />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <div class="header-content">
          <div class="logo">
            <svg class="pi-icon" viewBox="0 0 100 100" aria-hidden="true">
              <polygon
                points="15,0 50,20 15,40"
                style="fill: var(--status-high)"
              />
              <polygon
                points="85,0 50,20 85,60"
                style="fill: var(--status-high)"
              />
              <circle cx="50" cy="60" r="40" fill="currentColor" />
              <rect x="45" y="50" width="10" height="40" fill="white" rx="5" />
              <ellipse cx="50" cy="55" rx="18" ry="11" fill="#ffffff" />
            </svg>

            <div class="title">
              <h1>Raspi Web GPIO Controller</h1>
              <h2>Control and monitor GPIO pins through your web browser</h2>
            </div>
          </div>

          <div class="header-controls">
            <div class="status-indicator">
              <span class="status-dot" id="connectionStatus"></span>
              <span id="backendStatus">Connecting...</span>
            </div>

            <button
              id="resetAllBtn"
              class="btn btn-danger"
              title="Reset all pins to safe defaults"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9z"
                />
              </svg>
              Reset All
            </button>

            <button
              id="darkModeToggle"
              class="icon-btn"
              title="Toggle dark mode"
              aria-label="Toggle dark mode"
            >
              <svg class="theme-icon" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  class="sun-icon"
                  d="M12 0.5 L12.7 4 L11.3 4 Z M19.07 2.93 L16.48 6.52 L15.48 5.52 Z M23.5 12 L20 12.7 L20 11.3 Z M19.07 21.07 L15.48 17.48 L16.48 16.48 Z M12 23.5 L11.3 20 L12.7 20 Z M4.93 21.07 L8.52 17.48 L7.52 16.48 Z M0.5 12 L4 11.3 L4 12.7 Z M4.93 2.93 L8.52 6.52 L7.52 7.52 Z M12 5 A7 7 0 1 1 11.999 5 Z"
                />
                <path
                  class="moon-icon"
                  d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z "
                  style="display: none"
                  fill="#ffffff"
                />
              </svg>
            </button>
          </div>
        </div>
      </header>

      <!-- GPIO Status Grid -->
      <section class="section">
        <h2>GPIO Pin Status</h2>
        <div
          id="gpioGrid"
          class="gpio-grid"
          role="grid"
          aria-label="GPIO pin status grid"
        >
          <!-- GPIO pins will be generated by JavaScript -->
        </div>
      </section>

      <!-- Control Panels -->
      <div class="controls-container">
        <!-- Mode Configuration -->
        <section class="control-panel">
          <h3>‚ö≤ Pin Configuration</h3>

          <div class="form-group">
            <label for="configPin">Pin Number (BCM):</label>
            <select id="configPin" class="form-control">
              <option value="">Select pin...</option>
            </select>
          </div>

          <div class="form-group">
            <label>Mode:</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="pinMode" value="input" checked />
                <span>Input</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="pinMode" value="output" />
                <span>Output</span>
              </label>
            </div>
          </div>

          <div class="form-group" id="pullResistorGroup">
            <label>Pull Resistor:</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="pullResistor" value="off" checked />
                <span>Off</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="pullResistor" value="up" />
                <span>Pull-up</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="pullResistor" value="down" />
                <span>Pull-down</span>
              </label>
            </div>
          </div>

          <button id="configurePinBtn" class="btn btn-primary">
            Configure Pin
          </button>
        </section>

        <!-- Output Control -->
        <section class="control-panel">
          <h3>üñ∂ Output Control</h3>

          <div class="form-group">
            <label for="outputPin">Output Pin:</label>
            <select id="outputPin" class="form-control">
              <option value="">No output pins configured</option>
            </select>
          </div>

          <div class="button-group">
            <button id="setHighBtn" class="btn btn-success" disabled>
              Set HIGH
            </button>
            <button id="setLowBtn" class="btn btn-secondary" disabled>
              Set LOW
            </button>
          </div>

          <div class="form-group">
            <label for="pulseDuration">Pulse Duration (ms):</label>
            <input
              type="number"
              id="pulseDuration"
              class="form-control"
              value="100"
              min="1"
              max="10000"
            />
          </div>

          <div class="form-group">
            <label for="loops">No. of Pulses:</label>
            <input
              type="number"
              id="loops"
              class="form-control"
              value="5"
              min="1"
              max="20"
            />
          </div>

          <button id="pulseBtn" class="btn btn-warning" disabled>
            Send Pulse
          </button>
        </section>

        <!-- Input Monitor -->
        <section class="control-panel">
          <h3>üñ∞ Input Monitor</h3>

          <div class="form-group">
            <label for="inputPin">Input Pin:</label>
            <select id="inputPin" class="form-control">
              <option value="">No input pins configured</option>
            </select>
          </div>

          <div class="input-status">
            <div class="status-display">
              <span class="status-label">Current State:</span>
              <span id="inputValue" class="value-indicator">-</span>
            </div>
            <button id="toggleMonitorBtn" class="btn btn-info" disabled>
              Start Monitor
            </button>
          </div>

          <div class="event-log-container">
            <label>Event Log:</label>
            <div
              id="inputEventLog"
              class="event-log"
              role="log"
              aria-live="polite"
              aria-label="Input event log"
            ></div>
          </div>
        </section>

        <!-- PWM Control -->
        <section class="control-panel">
          <h3>„Ä∞ PWM Control</h3>

          <div class="form-group">
            <label for="pwmPin">PWM Pin:</label>
            <select id="pwmPin" class="form-control">
              <option value="">Select PWM pin...</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pwmFrequency">Frequency (Hz):</label>
            <input
              type="number"
              id="pwmFrequency"
              class="form-control"
              value="1000"
              min="1"
              max="100000"
              step="1"
            />
          </div>

          <div class="form-group">
            <label for="pwmDutyCycle"
              >Duty Cycle: <span id="dutyCycleValue">50</span>%</label
            >
            <input
              type="range"
              id="pwmDutyCycle"
              class="slider"
              min="0"
              max="100"
              value="50"
              step="1"
            />
          </div>

          <div class="pwm-status">
            <div class="status-info">
              <span id="pwmStatus">PWM Stopped</span>
            </div>
            <div class="button-group">
              <button id="startPwmBtn" class="btn btn-primary" disabled>
                Start PWM
              </button>
              <button id="stopPwmBtn" class="btn btn-secondary" disabled>
                Stop PWM
              </button>
            </div>
          </div>
        </section>
      </div>

      <!-- Activity Log -->
      <section class="section">
        <h2>Activity Log</h2>
        <div
          id="activityLog"
          class="activity-log"
          role="log"
          aria-live="polite"
          aria-label="System activity log"
        >
          <div class="log-entry info">
            <span class="timestamp">--:--:--</span>
            <span class="message">Initializing GPIO Controller...</span>
          </div>
        </div>
        <button id="clearLogBtn" class="btn btn-outline">Clear Log</button>
      </section>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <span class="footer-text"
          >Made with <span class="footer-heart" aria-label="love">‚ù§</span> by
          <a
            href="https://github.com/siddhantsilwal"
            target="_blank"
            rel="noopener"
            title="View on GitHub"
            aria-label="GitHub"
            >Siddhant Silwal</a
          >
          &amp; <b>You!</b></span
        >
        <a
          class="footer-github"
          href="https://github.com/SiddhantSilwal/RaspberryPI-GPIO-Web-Controller.git"
          target="_blank"
          rel="noopener"
          title="View on GitHub"
          aria-label="GitHub"
        >
          <svg
            class="github-icon"
            viewBox="0 0 24 24"
            aria-hidden="true"
            width="28"
            height="28"
            fill="currentColor"
          >
            <path
              d="M12 2C6.48 2 2 6.58 2 12.26c0 4.51 2.87 8.34 6.84 9.7.5.09.68-.22.68-.48 0-.24-.01-.87-.01-1.7-2.78.62-3.37-1.36-3.37-1.36-.45-1.18-1.1-1.5-1.1-1.5-.9-.63.07-.62.07-.62 1 .07 1.53 1.05 1.53 1.05.89 1.56 2.34 1.11 2.91.85.09-.66.35-1.11.63-1.37-2.22-.26-4.56-1.14-4.56-5.07 0-1.12.39-2.03 1.03-2.75-.1-.26-.45-1.3.1-2.7 0 0 .84-.28 2.75 1.05a9.38 9.38 0 012.5-.34c.85 0 1.71.11 2.5.34 1.91-1.33 2.75-1.05 2.75-1.05.55 1.4.2 2.44.1 2.7.64.72 1.03 1.63 1.03 2.75 0 3.94-2.34 4.81-4.57 5.07.36.32.68.94.68 1.9 0 1.37-.01 2.47-.01 2.81 0 .27.18.58.69.48A10.01 10.01 0 0022 12.26C22 6.58 17.52 2 12 2z"
            />
          </svg>
        </a>
      </div>
    </footer>
  </body>
</html>
